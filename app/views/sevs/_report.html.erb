<!-- Generate the report -->
<script>
var drugs=<%= raw @drugs.pluck(:id, :name) %>;
var symptoms=<%= raw @symptoms.pluck(:id, :name) %>;
var side_effects = <%= raw @side_effects.pluck(:id, :drug_id, :symptom_id) %>

function generate_report() {
  var drug_list = document.getElementById("drug-list");
  var symptom_select = document.getElementById("symptom-select");
  var symptom = symptom_select.options[symptom_select.selectedIndex];
  alert(symptom.value.toString() + symptom.text);
  /*
go through side effects,
if the symptom matches,
and the drug is in the drug-list,
then output the drug
  */
  side_effects.forEach(function(item,index) {
    var drugId = item[1];
    var symptomId = item[2];
    if (symptom.value == symptomId) {
      alert('matched ' + symptom.value.toString() + " " + symptomId.toString());
    } else {
      alert('NOT matched ' + symptom.value.toString() + " " + symptomId.toString());
    }
  });
}

</script>
